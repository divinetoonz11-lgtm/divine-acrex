(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1952],{5625:function(e,i,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/overview",function(){return r(3936)}])},3836:function(e,i,r){"use strict";r.d(i,{Z:function(){return AdminGuard}});var n=r(5893),t=r(7294);function AdminGuard(e){let{children:i}=e,[r,s]=(0,t.useState)(!0),[a,d]=(0,t.useState)(!1),[l,o]=(0,t.useState)(!1),[c,u]=(0,t.useState)(""),getKey=()=>{try{return sessionStorage.getItem("admin_key")||"mxNpQUAq7chKY1CBJVyOEkRgTMsbL3ferwIju0Wz"}catch(e){return"mxNpQUAq7chKY1CBJVyOEkRgTMsbL3ferwIju0Wz"}};(0,t.useEffect)(()=>{!async function(){s(!0);let e=getKey();if(!e){o(!0),s(!1);return}try{let i=await fetch("/api/admin/overview",{headers:{"x-admin-key":e}});if(i.ok){try{sessionStorage.setItem("admin_key",e)}catch(e){}d(!0)}else o(!0),sessionStorage.removeItem("admin_key")}catch(e){console.warn("Admin verify failed:",e),o(!0)}finally{s(!1)}}()},[]);let submitKey=async()=>{let e=c.trim();if(!e)return alert("Key required");s(!0);try{let i=await fetch("/api/admin/overview",{headers:{"x-admin-key":e}});i.ok?(sessionStorage.setItem("admin_key",e),d(!0),o(!1)):alert("Invalid admin key")}catch(e){alert("Network error: "+e.message)}finally{s(!1)}};return r?(0,n.jsx)("div",{style:{padding:20},children:"Checking admin accessâ€¦"}):l&&!a?(0,n.jsxs)("div",{style:{padding:20,maxWidth:600,margin:"40px auto",border:"1px solid #eee",borderRadius:8},children:[(0,n.jsx)("h3",{children:"Admin Access Required"}),(0,n.jsx)("p",{children:"Enter admin key to continue (session will remember it):"}),(0,n.jsx)("input",{value:c,onChange:e=>u(e.target.value),placeholder:"Enter admin key",style:{width:"100%",padding:10,borderRadius:6,border:"1px solid #ddd"}}),(0,n.jsxs)("div",{style:{marginTop:12,display:"flex",gap:8,justifyContent:"flex-end"},children:[(0,n.jsx)("button",{onClick:()=>{o(!1)},style:{padding:"8px 12px"},children:"Cancel"}),(0,n.jsx)("button",{onClick:submitKey,style:{padding:"8px 12px",background:"#27457a",color:"#fff",borderRadius:6},children:"Submit"})]}),(0,n.jsxs)("p",{style:{marginTop:12,fontSize:13,color:"#777"},children:["Tip: For local dev you can keep the same value as ",(0,n.jsx)("code",{children:"NEXT_PUBLIC_ADMIN_KEY"}),"."]})]}):(0,n.jsx)(n.Fragment,{children:i})}},3936:function(e,i,r){"use strict";r.r(i),r.d(i,{default:function(){return OverviewWithGuard}});var n=r(5893),t=r(7294),s=r(3836);function AdminOverview(){let[e,i]=(0,t.useState)({users:0,dealers:0,properties:0,leads:0}),[r,s]=(0,t.useState)(!1),[c,u]=(0,t.useState)("");async function loadOverview(){s(!0),u("");try{let s=await fetch("/api/admin/overview",{headers:{"x-admin-key":"mxNpQUAq7chKY1CBJVyOEkRgTMsbL3ferwIju0Wz"}}),a=await s.json();if(s.ok){var e,r,n,t;let s=a.stats||{};i({users:null!==(e=s.users)&&void 0!==e?e:0,dealers:null!==(r=s.dealers)&&void 0!==r?r:0,properties:null!==(n=s.properties)&&void 0!==n?n:0,leads:null!==(t=s.leads)&&void 0!==t?t:0})}else u((null==a?void 0:a.error)||"Failed to load overview")}catch(e){u("Network error: "+e.message)}finally{s(!1)}}(0,t.useEffect)(()=>{loadOverview()},[]);let p=[{key:"users",label:"Users",value:e.users,hint:"Total registered users"},{key:"dealers",label:"Dealers",value:e.dealers,hint:"Approved dealers"},{key:"properties",label:"Properties",value:e.properties,hint:"Total listings"},{key:"leads",label:"Leads",value:e.leads,hint:"Enquiries received"}];return(0,n.jsxs)("div",{style:{padding:20},children:[(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:18},children:[(0,n.jsx)("h2",{children:"Admin Overview"}),(0,n.jsx)("div",{style:{display:"flex",gap:8},children:(0,n.jsx)("button",{onClick:loadOverview,style:o,children:r?"Refreshing...":"Refresh"})})]}),c&&(0,n.jsx)("div",{style:{marginBottom:12,color:"#7b0b0b",background:"#fee",padding:10,borderRadius:6},children:c}),(0,n.jsx)("div",{style:a,children:p.map(e=>(0,n.jsxs)("div",{style:d,children:[(0,n.jsx)("div",{style:{fontSize:14,color:"#6b7280"},children:e.label}),(0,n.jsx)("div",{style:{fontSize:28,fontWeight:700,marginTop:6},children:r?"...":e.value}),(0,n.jsx)("div",{style:{fontSize:12,color:"#9ca3af",marginTop:8},children:e.hint})]},e.key))}),(0,n.jsxs)("div",{style:{marginTop:18},children:[(0,n.jsx)("h4",{style:{marginBottom:8},children:"Quick actions"}),(0,n.jsxs)("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[(0,n.jsx)("button",{style:l,onClick:()=>window.location.href="/admin/users",children:"Manage Users"}),(0,n.jsx)("button",{style:l,onClick:()=>window.location.href="/admin/dealers",children:"Manage Dealers"}),(0,n.jsx)("button",{style:l,onClick:()=>window.location.href="/admin/properties",children:"Manage Properties"}),(0,n.jsx)("button",{style:l,onClick:()=>window.location.href="/admin/filters",children:"Filters"})]})]})]})}function OverviewWithGuard(e){return(0,n.jsx)(s.Z,{children:(0,n.jsx)(AdminOverview,{...e})})}let a={display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:12},d={background:"#fff",padding:16,borderRadius:8,boxShadow:"0 1px 4px rgba(0,0,0,0.05)",minHeight:100},l={padding:"8px 12px",background:"#27457a",color:"#fff",border:"none",borderRadius:6,cursor:"pointer"},o={padding:"8px 12px",background:"#f3f4f6",color:"#111827",border:"1px solid #e5e7eb",borderRadius:6,cursor:"pointer"}}},function(e){e.O(0,[9774,2888,179],function(){return e(e.s=5625)}),_N_E=e.O()}]);