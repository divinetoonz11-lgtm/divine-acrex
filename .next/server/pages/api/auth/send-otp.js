"use strict";(()=>{var e={};e.id=4698,e.ids=[4698],e.modules={145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6386:(e,t,s)=>{s.r(t),s.d(t,{config:()=>c,default:()=>d,routeModule:()=>m});var a={};s.r(a),s.d(a,{default:()=>handler});var r=s(1802),n=s(7153),i=s(6249),o=s(9822);let l=require("nodemailer");var u=s.n(l);async function handler(e,t){if("POST"!==e.method)return t.status(405).json({success:!1,message:"Method not allowed"});let{identifier:s,type:a,role:r}=e.body;if(!s)return t.status(400).json({success:!1,message:"Missing identifier"});let n=Math.floor(1e5+9e5*Math.random()).toString(),i=new Date(Date.now()+6e5);if(await o.Z.otp.create({data:{identifier:s,type:a,otp:n,expiresAt:i}}),"email"===a)try{let e=u().createTransport(process.env.EMAIL_SERVER);return await e.sendMail({from:process.env.EMAIL_FROM,to:s,subject:"Your DivineAcrex Login OTP",text:`Your DivineAcrex Login OTP is: ${n}
Valid for 10 minutes.
Do not share with anyone.`}),t.status(200).json({success:!0})}catch(e){return console.error("EMAIL OTP ERROR:",e),t.status(500).json({success:!1,message:"Failed to send email OTP"})}return t.status(200).json({success:!0,message:"Phone OTP system not enabled yet"})}let d=(0,i.l)(a,"default"),c=(0,i.l)(a,"config"),m=new r.PagesAPIRouteModule({definition:{kind:n.x.PAGES_API,page:"/api/auth/send-otp",pathname:"/api/auth/send-otp",bundlePath:"",filename:""},userland:a})},9822:(e,t,s)=>{let a;s.d(t,{Z:()=>n});let r=require("@prisma/client");global.prisma||(global.prisma=new r.PrismaClient),a=global.prisma;let n=a}};var t=require("../../../webpack-api-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),s=t.X(0,[4222],()=>__webpack_exec__(6386));module.exports=s})();